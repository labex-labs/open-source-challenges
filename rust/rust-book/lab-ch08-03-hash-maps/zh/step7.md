# 仅在键不存在时添加键值对

通常需要检查哈希映射中是否已经存在某个特定的键及其对应的值，然后采取以下操作：如果该键在哈希映射中确实存在，则现有值应保持不变；如果该键不存在，则插入它及其对应的值。

哈希映射为此提供了一个特殊的 API，称为 `entry`，它将你要检查的键作为参数。`entry` 方法的返回值是一个名为 `Entry` 的枚举，它表示一个可能存在也可能不存在的值。假设我们要检查黄色队伍的键是否有与之关联的值。如果没有，我们想插入值 `50`，蓝色队伍也是如此。使用 `entry` API，代码如下清单 8-24 所示。

```rust
use std::collections::HashMap;

let mut scores = HashMap::new();
scores.insert(String::from("Blue"), 10);

scores.entry(String::from("Yellow")).or_insert(50);
scores.entry(String::from("Blue")).or_insert(50);

println!("{:?}", scores);
```

清单 8-24：使用 `entry` 方法仅在键不存在时进行插入

`Entry` 上的 `or_insert` 方法定义为：如果对应 `Entry` 键存在，则返回对该键对应值的可变引用；如果不存在，则将参数作为此键的新值插入，并返回对新值的可变引用。这种技术比我们自己编写逻辑要简洁得多，此外，它与借用检查器配合得也更好。

运行清单 8-24 中的代码将打印 `{"Yellow": 50, "Blue": 10}`。第一次调用 `entry` 将插入黄色队伍的键及其值 `50`，因为黄色队伍之前没有值。第二次调用 `entry` 不会改变哈希映射，因为蓝色队伍已经有值 `10` 了。
