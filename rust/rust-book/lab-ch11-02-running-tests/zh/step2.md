# 并行或连续运行测试

当你运行多个测试时，默认情况下它们会使用线程并行运行，这意味着它们完成运行的速度更快，你也能更快地得到反馈。由于测试是同时运行的，所以你必须确保你的测试之间不相互依赖，也不依赖于任何共享状态，包括共享环境，比如当前工作目录或环境变量。

例如，假设你的每个测试都会运行一些代码，这些代码会在磁盘上创建一个名为 _test-output.txt_ 的文件，并向该文件写入一些数据。然后每个测试读取该文件中的数据，并断言该文件包含特定的值，每个测试中的值都不同。由于测试是同时运行的，一个测试可能会在另一个测试写入和读取文件的时间段内覆盖该文件。这样第二个测试就会失败，不是因为代码不正确，而是因为测试在并行运行时相互干扰了。一种解决方案是确保每个测试写入不同的文件；另一种解决方案是一次运行一个测试。

如果你不想并行运行测试，或者想要对使用的线程数进行更细粒度的控制，可以将 `--test-threads` 标志和你想要使用的线程数传递给测试二进制文件。看一下下面的例子：

```bash
cargo test -- --test-threads=1
```

我们将测试线程数设置为 `1`，这告诉程序不要使用任何并行性。使用一个线程运行测试会比并行运行花费更长的时间，但如果测试共享状态，它们就不会相互干扰。
