# Bash Scripting Loops

## Introduction

In this lab, you will learn how to use loops in Bash scripting. Loops are powerful tools that allow you to repeat a set of instructions multiple times, making your scripts more efficient and flexible. We will cover three types of loops: `for`, `while`, and `until`. Additionally, you will explore the `break` and `continue` statements, which provide control over loop execution. This lab is designed for beginners and will guide you through each concept step-by-step.

## Steps

### Step 1: Setting Up the Environment

Let's start by setting up our working environment. We'll create a new directory to store all our loop experiments.

Open a terminal in the WebIDE. You should be in the `/home/labex/project` directory by default. If you're not sure, you can always navigate there using this command:

```bash
cd /home/labex/project
```

Now, let's create a new directory for our loop experiments:

```bash
mkdir bash_loops
cd bash_loops
```

This creates a new directory called `bash_loops` and changes into it. We'll use this directory for all our loop experiments.

Why are we doing this? Organizing your scripts into directories is a good practice. It keeps your work tidy and makes it easier to find and manage your files.

#### Verification

```yaml
- name: Verify bash_loops directory
  script: |
    #!/bin/bash
    if [[ -d /home/labex/project/bash_loops ]]; then
      exit 0
    else
      exit 1
    fi
  hint: The bash_loops directory was not created correctly. Make sure you ran the mkdir command in the /home/labex/project directory.
```

### Step 2: The `for` Loop

The `for` loop is used to iterate over a list of values. It's like saying, "For each item in this list, do something." Let's create a script that demonstrates how to use a `for` loop.

Create a new file called `for_loop.sh` in the `bash_loops` directory:

```bash
touch for_loop.sh
```

Now, open the `for_loop.sh` file in the WebIDE and add the following content:

```bash
#!/bin/bash

# Loop through an array of names
echo "Looping through an array:"
NAMES=("Alice" "Bob" "Charlie" "David")
for name in "${NAMES[@]}"; do
  echo "Hello, $name!"
done

echo # Print an empty line for readability

# Loop through a range of numbers
echo "Looping through a range of numbers:"
for i in {1..5}; do
  echo "Number: $i"
done
```

Let's break down what this script does:

1. The first loop goes through an array of names. For each name in the array, it prints a greeting.
2. The second loop uses a range `{1..5}` to count from 1 to 5.

The `"${NAMES[@]}"` syntax might look strange. The `@` means "all elements of the array," and the quotes and curly braces ensure that each element is treated as a separate item, even if it contains spaces.

Save the file and make it executable with this command:

```bash
chmod +x for_loop.sh
```

The `chmod +x` command makes the file executable, which means you can run it as a program.

Now, run the script:

```bash
./for_loop.sh
```

You should see output like this:

```
Looping through an array:
Hello, Alice!
Hello, Bob!
Hello, Charlie!
Hello, David!

Looping through a range of numbers:
Number: 1
Number: 2
Number: 3
Number: 4
Number: 5
```

This demonstrates how `for` loops can iterate over both arrays and ranges of numbers.

#### Verification

```yaml
- name: Verify for_loop.sh content
  script: |
    #!/bin/bash
    if grep -q "for name in" /home/labex/project/bash_loops/for_loop.sh; then
      exit 0
    else
      exit 1
    fi
  hint: The for_loop.sh file does not contain the expected for loop example. Make sure you copied the provided script correctly.
```

### Step 3: The `while` Loop

The `while` loop executes a block of code as long as a specified condition is true. It's like saying, "While this condition is true, keep doing this."

Create a new file called `while_loop.sh`:

```bash
touch while_loop.sh
```

Open the `while_loop.sh` file in the WebIDE and add the following content:

```bash
#!/bin/bash

# Simple countdown using a while loop
count=5
echo "Countdown:"
while [ $count -gt 0 ]; do
  echo $count
  count=$((count - 1))
  sleep 1 # Wait for 1 second
done
echo "Blast off!"
```

Let's break down this script:

1. We start with `count=5` to set our initial countdown value.
2. The condition `[ $count -gt 0 ]` means "while count is greater than 0".
3. Inside the loop, we print the current count, decrease it by 1, and wait for a second.
4. This continues until count reaches 0, at which point the loop ends.

The `sleep 1` command pauses the script for 1 second, creating a real-time countdown effect.

Save the file and make it executable:

```bash
chmod +x while_loop.sh
```

Now, run the script:

```bash
./while_loop.sh
```

You'll see a countdown from 5 to 1, with a one-second pause between each number:

```
Countdown:
5
4
3
2
1
Blast off!
```

This demonstrates how a `while` loop can repeat an action until a condition is no longer true.

#### Verification

```yaml
- name: Verify while_loop.sh content
  script: |
    #!/bin/bash
    if grep -q "while \[ \$count -gt 0 ]" /home/labex/project/bash_loops/while_loop.sh; then
      exit 0
    else
      exit 1
    fi
  hint: The while_loop.sh file does not contain the expected while loop example. Make sure you copied the provided script correctly.
```

### Step 4: The `until` Loop

The `until` loop is similar to the `while` loop, but with an important difference: it continues executing until a specified condition becomes true. It's like saying, "Keep doing this until this condition is true."

Create a new file called `until_loop.sh`:

```bash
touch until_loop.sh
```

Open the `until_loop.sh` file in the WebIDE and add the following content:

```bash
#!/bin/bash

# Count up to 5 using an until loop
count=1
echo "Counting up to 5:"
until [ $count -gt 5 ]; do
  echo $count
  count=$((count + 1))
  sleep 1 # Wait for 1 second
done
```

Let's break down this script:

1. We start with `count=1` as our initial value.
2. The condition `[ $count -gt 5 ]` means "until count is greater than 5".
3. Inside the loop, we print the current count, increase it by 1, and wait for a second.
4. This continues until count becomes greater than 5, at which point the loop ends.

Save the file and make it executable:

```bash
chmod +x until_loop.sh
```

Now, run the script:

```bash
./until_loop.sh
```

You'll see the numbers 1 through 5 printed, with a one-second pause between each:

```
Counting up to 5:
1
2
3
4
5
```

This demonstrates how an `until` loop can repeat an action until a condition becomes true.

#### Verification

```yaml
- name: Verify until_loop.sh content
  script: |
    #!/bin/bash
    if grep -q "until \[ \$count -gt 5 ]" /home/labex/project/bash_loops/until_loop.sh; then
      exit 0
    else
      exit 1
    fi
  hint: The until_loop.sh file does not contain the expected until loop example. Make sure you copied the provided script correctly.
```

### Step 5: Using `break` and `continue` Statements

The `break` and `continue` statements are used to control the flow of loops. `break` exits a loop early, while `continue` skips the rest of the current iteration and moves to the next one.

Create a new file called `break_continue.sh`:

```bash
touch break_continue.sh
```

Open the `break_continue.sh` file in the WebIDE and add the following content:

```bash
#!/bin/bash

# Using break to exit a loop early
echo "Demonstration of break:"
for i in {1..10}; do
  if [ $i -eq 6 ]; then
    echo "Breaking the loop at $i"
    break
  fi
  echo $i
done

echo # Print an empty line for readability

# Using continue to skip iterations
echo "Demonstration of continue (printing odd numbers):"
for i in {1..10}; do
  if [ $((i % 2)) -eq 0 ]; then
    continue
  fi
  echo $i
done
```

Let's break down this script:

1. In the first loop, we use `break` to exit the loop when `i` equals 6.
2. In the second loop, we use `continue` to skip even numbers. The condition `$((i % 2)) -eq 0` checks if a number is even (divisible by 2 with no remainder).

The `%` operator calculates the remainder after division. So `i % 2` will be 0 for even numbers and 1 for odd numbers.

Save the file and make it executable:

```bash
chmod +x break_continue.sh
```

Now, run the script:

```bash
./break_continue.sh
```

You should see output like this:

```
Demonstration of break:
1
2
3
4
5
Breaking the loop at 6

Demonstration of continue (printing odd numbers):
1
3
5
7
9
```

This demonstrates how `break` can exit a loop early, and how `continue` can skip certain iterations based on a condition.

#### Verification

```yaml
- name: Verify break_continue.sh content
  script: |
    #!/bin/bash
    if grep -q "break" /home/labex/project/bash_loops/break_continue.sh && grep -q "continue" /home/labex/project/bash_loops/break_continue.sh; then
      exit 0
    else
      exit 1
    fi
  hint: The break_continue.sh file does not contain the expected break and continue examples. Make sure you copied the provided script correctly.
```

## Summary

In this lab, you've learned about three types of loops in Bash scripting:

1. `for` loops, which iterate over a list of items or a range of numbers.
2. `while` loops, which continue as long as a condition is true.
3. `until` loops, which continue until a condition becomes true.

You've also learned about `break` and `continue` statements, which give you more control over your loops.

These loop structures are fundamental to many scripts and will allow you to automate repetitive tasks efficiently. Practice using these loops in your own scripts to become more familiar with their behavior and use cases.
